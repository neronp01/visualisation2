<!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Starter Kit</title>

    <!-- Disable tap highlight on IE -->
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Web Application Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Web Starter Kit">
    <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Web Starter Kit">
    <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#2F3BA2">

    <!-- Color the status bar on mobile devices -->
    <meta name="theme-color" content="#2F3BA2">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->

    <!-- Material Design icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">


    <!-- Material Design Lite page styles:
    You can choose other color schemes from the CDN, more info here http://www.getmdl.io/customize/index.html
    Format: material.color1-color2.min.css, some examples:
    material.red-teal.min.css
    material.blue-orange.min.css
    material.purple-indigo.min.css
    -->


    <!-- Your styles -->
    <link rel="stylesheet" href="styles/main.css">
  </head>
  <body class="mdl-demo mdl-color--grey-100 mdl-color-text--grey-700 mdl-base">






    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header mdl-layout__header--scroll mdl-color--primary">
        <div class="mdl-layout--large-screen-only mdl-layout__header-row ">
        </div>
        <div class="mdl-layout--large-screen-only mdl-layout__header-row">
          <h3>Catalogue de visualisation</h3>
        </div>
        <div class="mdl-layout--large-screen-only mdl-layout__header-row">
        </div>
        <div class="mdl-layout__tab-bar mdl-js-ripple-effect mdl-color--primary-dark">
          <a href="#overview" class="mdl-layout__tab is-active">Overview</a>
          <a href="#features" class="mdl-layout__tab" id="feature">Features</a>
          <a href="#features" class="mdl-layout__tab">Details</a>
          <a href="#features" class="mdl-layout__tab">Technology</a>
          <a href="#features" class="mdl-layout__tab">FAQ</a>
          <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored mdl-shadow--4dp mdl-color--accent" id="add">
            <i class="material-icons" role="presentation">add</i>
            <span class="visuallyhidden">Add</span>
          </button>
        </div>
      </header>

      <main class="mdl-layout__content">
        <div class="mdl-layout__tab-panel is-active" id="overview">
          <section class="section--center mdl-grid mdl-grid--no-spacing mdl-shadow--2dp">
            <header class="section__play-btn mdl-cell mdl-cell--3-col-desktop mdl-cell--2-col-tablet mdl-cell--4-col-phone mdl-color--teal-100 mdl-color-text--white">
              <i class="material-icons">play_circle_filled</i>
            </header>
            <div class="mdl-card mdl-cell mdl-cell--9-col-desktop mdl-cell--6-col-tablet mdl-cell--4-col-phone">
              <div class="mdl-card__supporting-text">
                <h4>Features</h4>
                Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu. Nostrud in laboris labore nisi amet do dolor eu fugiat consectetur elit cillum esse.
              </div>
              <div class="mdl-card__actions">
                <a href="#" class="mdl-button">Read our features</a>
              </div>
            </div>
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" id="btn1">
              <i class="material-icons">more_vert</i>
            </button>
            <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right" for="btn1">
              <li class="mdl-menu__item">Lorem</li>
              <li class="mdl-menu__item" disabled>Ipsum</li>
              <li class="mdl-menu__item">Dolor</li>
            </ul>
          </section>
          <section class="section--center mdl-grid mdl-grid--no-spacing mdl-shadow--2dp">
            <div class="mdl-card mdl-cell mdl-cell--12-col">
              <div class="mdl-card__supporting-text mdl-grid mdl-grid--no-spacing">
                <h4 class="mdl-cell mdl-cell--12-col">Details</h4>
                <div class="section__circle-container mdl-cell mdl-cell--2-col mdl-cell--1-col-phone">
                  <div class="section__circle-container__circle mdl-color--primary"></div>
                </div>
                <div class="section__text mdl-cell mdl-cell--10-col-desktop mdl-cell--6-col-tablet mdl-cell--3-col-phone">
                  <h5>Lorem ipsum dolor sit amet</h5>
                  Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu. Duis nulla tempor do aute et eiusmod velit exercitation nostrud quis <a href="#">proident minim</a>.
                </div>
                <div class="section__circle-container mdl-cell mdl-cell--2-col mdl-cell--1-col-phone">
                  <div class="section__circle-container__circle mdl-color--primary"></div>
                </div>
                <div class="section__text mdl-cell mdl-cell--10-col-desktop mdl-cell--6-col-tablet mdl-cell--3-col-phone">
                  <h5>Lorem ipsum dolor sit amet</h5>
                  Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu. Duis nulla tempor do aute et eiusmod velit exercitation nostrud quis <a href="#">proident minim</a>.
                </div>
                <div class="section__circle-container mdl-cell mdl-cell--2-col mdl-cell--1-col-phone">
                  <div class="section__circle-container__circle mdl-color--primary"></div>
                </div>
                <div class="section__text mdl-cell mdl-cell--10-col-desktop mdl-cell--6-col-tablet mdl-cell--3-col-phone">
                  <h5>Lorem ipsum dolor sit amet</h5>
                  Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu. Duis nulla tempor do aute et eiusmod velit exercitation nostrud quis <a href="#">proident minim</a>.
                </div>
              </div>
              <div class="mdl-card__actions">
                <a href="#" class="mdl-button">Read our features</a>
              </div>
            </div>
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" id="btn2">
              <i class="material-icons">more_vert</i>
            </button>
            <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right" for="btn2">
              <li class="mdl-menu__item">Lorem</li>
              <li class="mdl-menu__item" disabled>Ipsum</li>
              <li class="mdl-menu__item">Dolor</li>
            </ul>
          </section>
          <section class="section--center mdl-grid mdl-grid--no-spacing mdl-shadow--2dp">
            <div class="mdl-card mdl-cell mdl-cell--12-col">
              <div class="mdl-card__supporting-text">
                <h4>Technology</h4>
                Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu. Nostrud in laboris labore nisi amet do dolor eu fugiat consectetur elit cillum esse. Pariatur occaecat nisi laboris tempor laboris eiusmod qui id Lorem esse commodo in. Exercitation aute dolore deserunt culpa consequat elit labore incididunt elit anim.
              </div>
              <div class="mdl-card__actions">
                <a href="#" class="mdl-button">Read our features</a>
              </div>
            </div>
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" id="btn3">
              <i class="material-icons">more_vert</i>
            </button>
            <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right" for="btn3">
              <li class="mdl-menu__item">Lorem</li>
              <li class="mdl-menu__item" disabled>Ipsum</li>
              <li class="mdl-menu__item">Dolor</li>
            </ul>
          </section>
          <section class="section--footer mdl-color--white mdl-grid">
            <div class="section__circle-container mdl-cell mdl-cell--2-col mdl-cell--1-col-phone">
              <div class="section__circle-container__circle mdl-color--accent section__circle--big"></div>
            </div>
            <div class="section__text mdl-cell mdl-cell--4-col-desktop mdl-cell--6-col-tablet mdl-cell--3-col-phone">
              <h5>Lorem ipsum dolor sit amet</h5>
              Qui sint ut et qui nisi cupidatat. Reprehenderit nostrud proident officia exercitation anim et pariatur ex.
            </div>
            <div class="section__circle-container mdl-cell mdl-cell--2-col mdl-cell--1-col-phone">
              <div class="section__circle-container__circle mdl-color--accent section__circle--big"></div>
            </div>
            <div class="section__text mdl-cell mdl-cell--4-col-desktop mdl-cell--6-col-tablet mdl-cell--3-col-phone">
              <h5>Lorem ipsum dolor sit amet</h5>
              Qui sint ut et qui nisi cupidatat. Reprehenderit nostrud proident officia exercitation anim et pariatur ex.
            </div>
          </section>
        </div>
        <div class="mdl-layout__tab-panel" id="features">
          <section class=" mdl-grid mdl-grid--no-spacing">
            <!--<div class="mdl-cell mdl-cell&#45;&#45;12-col"></div>-->



            <section class="section--center mdl-grid mdl-grid--no-spacing mdl-shadow--2dp sectionGauche">
                  <div class="mdl-cell mdl-cell--12-col-desktop mdl-card__supporting-text" >
                  <svg id="coteDroitCercles" width="800" height="800">
                  </svg>
                  </div>
            </section>
            <section class="section--center mdl-grid mdl-grid--no-spacing mdl-shadow--2dp sectionDroite">
                <div class="mdl-cell mdl-cell--12-col-desktop mdl-card__supporting-text" id="coteGauche">
                  <div class="scroll">
                    <div id="countainerDroit"></div>
                  </div>
                </div>
            </section>


          </section>
        </div>


        <footer class="mdl-mega-footer">
          <div class="mdl-mega-footer--middle-section">
            <div class="mdl-mega-footer--drop-down-section">
              <input class="mdl-mega-footer--heading-checkbox" type="checkbox" checked>
              <h1 class="mdl-mega-footer--heading">Features</h1>
              <ul class="mdl-mega-footer--link-list">
                <li><a href="#">About</a></li>
                <li><a href="#">Terms</a></li>
                <li><a href="#">Partners</a></li>
                <li><a href="#">Updates</a></li>
              </ul>
            </div>
            <div class="mdl-mega-footer--drop-down-section">
              <input class="mdl-mega-footer--heading-checkbox" type="checkbox" checked>
              <h1 class="mdl-mega-footer--heading">Details</h1>
              <ul class="mdl-mega-footer--link-list">
                <li><a href="#">Spec</a></li>
                <li><a href="#">Tools</a></li>
                <li><a href="#">Resources</a></li>
              </ul>
            </div>
            <div class="mdl-mega-footer--drop-down-section">
              <input class="mdl-mega-footer--heading-checkbox" type="checkbox" checked>
              <h1 class="mdl-mega-footer--heading">Technology</h1>
              <ul class="mdl-mega-footer--link-list">
                <li><a href="#">How it works</a></li>
                <li><a href="#">Patterns</a></li>
                <li><a href="#">Usage</a></li>
                <li><a href="#">Products</a></li>
                <li><a href="#">Contracts</a></li>
              </ul>
            </div>
            <div class="mdl-mega-footer--drop-down-section">
              <input class="mdl-mega-footer--heading-checkbox" type="checkbox" checked>
              <h1 class="mdl-mega-footer--heading">FAQ</h1>
              <ul class="mdl-mega-footer--link-list">
                <li><a href="#">Questions</a></li>
                <li><a href="#">Answers</a></li>
                <li><a href="#">Contact us</a></li>
              </ul>
            </div>
          </div>
          <div class="mdl-mega-footer--bottom-section">
            <div class="mdl-logo">
              More Information
            </div>
            <ul class="mdl-mega-footer--link-list">
              <li><a href="https://developers.google.com/web/starter-kit/">Web Starter Kit</a></li>
              <li><a href="#">Help</a></li>
              <li><a href="#">Privacy and Terms</a></li>
            </ul>
          </div>
        </footer>
      </main>

    </div>

    <!-- build:js(app/) ../../scripts/main.min.js -->
    <script src="./scripts/d3/d3.js"></script>
    <script src="./scripts/d3/topojson.v1.min.js"></script>
    <script src="./scripts/components/pie/donut chart.js"></script>
    <script src="./scripts/components/food_drink/table.js"></script>
    <script src="./scripts/components/pie/Bilevel Partition.js"></script>
    <script src="./scripts/components/food_drink/line.js"></script>
    <script src="./scripts/components/census/d3-canada-map.js"></script>
    <script src="./scripts/components/census/sgc.js"></script>
    <script src="./styles/src/mdlComponentHandler.js"></script>
    <script src="./styles/src/button/button.js"></script>
    <script src="./styles/src/checkbox/checkbox.js"></script>
    <script src="./styles/src/icon-toggle/icon-toggle.js"></script>
    <script src="./styles/src/menu/menu.js"></script>
    <script src="./styles/src/progress/progress.js"></script>
    <script src="./styles/src/radio/radio.js"></script>
    <script src="./styles/src/slider/slider.js"></script>
    <script src="./styles/src/spinner/spinner.js"></script>
    <script src="./styles/src/switch/switch.js"></script>
    <script src="./styles/src/tabs/tabs.js"></script>
    <script src="./styles/src/textfield/textfield.js"></script>
    <script src="./styles/src/tooltip/tooltip.js"></script>
    <script src="./styles/src/layout/layout.js"></script>
    <script src="./styles/src/data-table/data-table.js"></script>
    <script src="./styles/src/ripple/ripple.js"></script>
    <script src="scripts/main.js"></script>
    <!-- endbuild -->
    <script src="https://d3js.org/d3.v4.js"></script>

    <script>
      d3.select("#feature")
        .on("click",function(){
          d3.selectAll(".mdl-layout--large-screen-only")
            .remove();

        })


    </script>
    <script>

      var doccCont =  d3.select(".scroll").append("div").attr("id","zoomableCircle").attr("class","docc");
      var docc = doccCont.append("div")
          .attr("class","text_droite"),
        text_docc = docc
          .append("p")
          .text("Bonjour,")
          .append("p")
          .text(" Vous voici dans l’application de la doccumentation de l’équipe de visualisation de statistique Canada. Dans cette application vous verrez les visualisations ainsi que la doccumentation des différents projets que l’équipe de visualistion on développé au cours des derniers mois. De plus, des exemples de visualisations sont montré et doccumenter affin de pouvoir les utilisés dans de futur projets. Les projets réalisés sont regroupé et expliquer dans une premier niveau. Chaque visualisation ont leurs propre doccumentation. Vous n’avez qu’à cliquer sur celci.")
          .append("br");
      var ligne = docc
          .append("hr")
          .attr("class","separator_line"),
        sautLine = docc
          .append("br"),
        titre_Zoomable = docc
          .append("h1")
          .attr("class","title_visualisation")
          .text("Zoomable Circle Packing"),
        Zoomable_Circle_docc = doccCont
          .append("div")
          .attr("class","text_droite"),
        premierPara = Zoomable_Circle_docc
          .append("p")
          .text("Cette platform nous permet de rassembler des éléments que ce soit des projets faits dans le passé ou des éléments que nous voulons expérimenter. Les éléments mis dans les cercles doivent être obligatoirement “scalable”. C’est pourquoi les visualisation se prête bien à cette platforme, étant donné que nous travaillont avec des éléments vectoriel. Parcontre certains éléments ont été modifier pour entrer dans les cercles. En effet les tables utilisées dans food drink ont été remplacées par des éléments rect étant donné que les tables ne sont pas scalable.")
      separateurCircle = doccCont
        .append("svg")
        .attr("width",800)
        .attr("height",30)
      circle1 = separateurCircle
        .append("circle")
        .attr("cx",350)
        .attr("cy",20)
        .attr("r",10)
        .attr("fill","rgb(225,225,225)")
      circle2 = separateurCircle
        .append("circle")
        .attr("cx",380)
        .attr("cy",20)
        .attr("r",10)
        .attr("fill","rgb(225,225,225)")
      circle3 = separateurCircle
        .append("circle")
        .attr("cx",410)
        .attr("cy",20)
        .attr("r",10)
        .attr("fill","rgb(225,225,225)")
      deuxiemePar = doccCont
        .append("div")
        .attr("class","text_droite"),
        text_ParagUn = deuxiemePar
          .append("p")
          .text("Cette visualisation est relativement simple. Chaque cercle est un élément du fichier flare.json. Ceux-ci ont un nom et une dimention. Si un cercle englobe d’autre cercle alors la dimention du cercle parent est l’addition des dimentions des cercles enfents + les marges que nous affectont pour les objects."),
        saut_ligne1 = text_ParagUn
          .append("br"),
        saut_ligne2 = text_ParagUn
          .append("br"),
        text_Paragdeux = deuxiemePar
          .append("p")
          .text("Pour y inséré une visualisation, vous devez la mettre dans le dossier js/components. Comme vous le remarquerai, ils sont classé par projet. Donc, la map du Canada est dans js/components/food_drink/canadaMap.js. Par la suite vous devez choisir un cercle pour y insérer votre élément. Quand vous avez choisi le cercle vous cliquer pour ogmenter la taille. Quand la taille est au maximum vous n’avez qu’à centre votre visualisation dans le cercle. Par la suite entré le code si bas dans le switch de la function zoomTo(). ")
      ref_zoomCicle_container = doccCont
        .append("div")
        .attr("class","ref"),
        text_ref = ref_zoomCicle_container
          .append("p")
          .text("Référence : Mike Bostock’s, ")
          .append("a")
          .attr("href","https://bl.ocks.org/mbostock/7607535")
          .style("color","rgb(191,191,191")
          .text("https://bl.ocks.org/mbostock/7607535")




      var svg = d3.select("#coteDroitCercles"),
        margin = 20,
        diameter = +svg.attr("width"),
        g = svg.append("g").attr("transform", "translate(" + diameter / 2 + "," + diameter / 2 + ")").attr("class","platformCircle"),
        width = +svg.attr("width"),
        height = +svg.attr("height")
      ;

      d3.select("#add")
        .on("click",function(){
          d3.select(".sectionDroite")
            .remove()
          d3.select(".sectionGauche")
            .transition()
            .duration(2000)
            .style("width","1600px")
            .style("height","1600px")
          d3.select("#coteDroitCercles")
            .transition()
            .duration(2000)
            .attr("transform","translate(380,380),scale(2)")
          console.log("test");
        })
      //d3.axisBottom(xRange).tickFormat(function(d){ return d.x;});


      var donut = donutChart()
        .width(960)
        .height(500)
        .cornerRadius(3) // sets how rounded the corners are on each slice
        .padAngle(0.015) // effectively dictates the gap between slices
        .variable('Probability')
        .category('Species');

      d3.tsv('species.tsv', function(error, data) {
        if (error) throw error;
        d3.select('#coteDroitCercles')
          .datum(data) // bind data to the div
          .call(donut); // draw chart in div
      });

      var color = d3.scaleLinear()
        .domain([-1, 5])
        .range(["hsl(0,100%,100%)", "hsl(0,0%,30%)"])
        .interpolate(d3.interpolateHcl);

      var pack = d3.pack()
        .size([diameter - margin, diameter - margin])
        .padding(2);

      // parse the date / time
      var parseTime = d3.timeParse("%d-%b-%y");

      // set the ranges
      var x = d3.scaleTime().range([0, 700]);
      var y = d3.scaleLinear().range([250, 0]);
      var xAxis = d3.axisBottom(x);
      var yAxis = d3.axisLeft(y);
      // define the 1st line
      var valueline = d3.line()
        .x(function (d) {
          return x(d.date);
        })
        .y(function (d) {
          return y(d.close);
        });

      // define the 2nd line
      var valueline2 = d3.line()
        .x(function (d) {
          return x(d.date);
        })
        .y(function (d) {
          return y(d.open);
        });
      d3.selectAll(".docc").style("visibility","hidden");
      d3.selectAll("#zoomableCircle").style("visibility","visible");



      d3.queue()
        .defer(d3.json, "flare.json")
        .defer(d3.json,"canada.json")
        .defer(d3.json,"dataLine.json")
        .await(ready);


      function ready(error, root,canada,dataChartLine) {
        if (error) throw error;
        dataChartLine.forEach(function(d) {
          var prov = Object.keys(d)[0];
          d[prov].forEach(function (p1) {
            p1.date = parseTime(p1.date);
          })
        });

     //   bilevelPartition(root,g);
        var canadaData = dataChartLine[0],

          table = svg.append("g").attr("class","table"),
          sett = function (name,v) {

            var date = function () {
              var tableDate = [];
              v.forEach(function(d){
                var date = {};
// https://github.com/d3/d3-time-format
                date = d.date;
                var formatTime = d3.timeFormat("%B %d, %Y");
                date = formatTime(date);
                return tableDate.push(date);
              });
              return tableDate;
            };

            var valeur = function(){
              var tableValue = [];
              v.forEach(function(d){
                var date = d.date;
                var formatTime = d3.timeFormat("%B %d, %Y");
                date = formatTime(date);
                var data = {
                  date:date,
                  close:d.close,
                  open:d.open
                };
                return tableValue.push(data);
              });

              return tableValue;
            };

            return {
              titre:name,
              date:date(),
              valeur:valeur()
            }
          };




        getTable(table,sett("Canada",canadaData.canada),dataChartLine);


        var root = d3.hierarchy(root)
          .sum(function (d) {
            return d.size;
          })
          .sort(function (a, b) {
            return b.value - a.value;
          });
        //  var demoTable =svg.append("g").append("table").attr("id","test23").attr("style", "margin-left: 250px");


        mapX=300,mapY=380
        var canadaMap = svg.append("g");


        var canadaChartLine = svg
          .append("g")
          .attr("id","donutChart1");

        getLineChart(canadaData.canada);

        var focus = root,
          nodes = pack(root).descendants(),
          view;

        var tran = nodes;
        //  getCodeQueue(svg, tran, nodes[2].children[1].children[0].x, nodes[2].children[1].children[0].y);

        for (var p = 0; p < canada.objects.PR2016CBF.geometries.length; p++) {
          geoProp = canada.objects.PR2016CBF.geometries[p].properties;
          geoProp.PRCODE = sgc.province.getCodeFromSGC(geoProp.PRUID);
        }

        getCanadaMap(canadaMap, {
          baseMap: canada,
        },mapX,mapY);
        //       var peopleTable = tabulate(sett("Canada",canadaData.canada).valeur, ["close", "open"]);

        var circle = g.selectAll("circle")
          .data(nodes)
          .enter().append("circle")
          .attr("class", function (d) {
            return d.parent ? d.children ? "node" : "node node--leaf" : "node node--root";
          })
          .style("fill", function (d) {
            return d.children ? color(d.depth) : null;
          })
          .on("click", function (d) {
            d3.select("#selection").remove();
            var docc = d.children[0].data.docc;
            var titre = d.children[0].data.name;
            if(docc!== undefined){
              affficheDocc(docc,titre)

            }

            d3.selectAll(".docc").style("visibility","hidden");
            if(d.data.name ==="food_drink"){
              d3.select("#food_drink").style("visibility","visible");
            }
            tran = d;
            if (focus !== d)zoom(d), d3.event.stopPropagation()
          });

        function affficheDocc(v,titre) {
          var countainer = d3.select("#countainerDroit");
          var droite = countainer.append("div")
            .attr("id","selection");

          v.forEach(function (p1,p2) {
            var objName = Object.keys(p1)[0];

            switch (objName){
              case "p":
                droite.append("div")
                  .attr("class","text_droite")
                  .attr("width",840)
                  .append("p")
                  .text(p1[objName]);
                break;
              case "SautLigne":

                if(p1[objName]==="br") {
                  droite.append("div")
                    .attr("class", "saut_ligne")
                    .append(p1[objName])
                }else if(p1[objName]==="hr"){
                  droite.append("div")
                    .attr("class", "saut_ligne")
                    .append(p1[objName])

                }else{
                  var svg = droite
                    .append("svg")
                    .attr("id",p1[objName])
                    .attr("width", 840)
                    .attr("height", 30)
                    .attr("class","svg_separateur")
                  svg.append("circle")
                    .attr("cx",350)
                    .attr("cy",20)
                    .attr("r", 10)
                    .style("fill","rgb(225,225,225)")
                  svg.append("circle")
                    .attr("cx",380)
                    .attr("cy",20)
                    .attr("r", 10)
                    .style("fill","rgb(225,225,225)")
                  svg.append("circle")
                    .attr("cx",410)
                    .attr("cy",20)
                    .attr("r", 10)
                    .style("fill","rgb(225,225,225)")
                }
                break;
              case "h1":
                droite.append("h1")
                  .text(titre)
                break;

              case "h2":
                droite.append("h2")
                  .text(p1.h2)
                ;
                break;

              case "svg":
//                droite.append("h2")
//                    .text(p1.h2)
//                    .on("click",function (d) {
//                        var doccTemp = [];
//                        docc.map(function(q1,q2){
//                            if(q2!==p2){
//                                return doccTemp.push(q1);
//                            }
//                        });
//                        docc = doccTemp;
//                        d3.select(this).remove();
//                        parcourtDroite(docc);
//                    });


                break;
            }
          })
        }
        var text = g.selectAll(".label")
          .data(nodes)
          .enter().append("text")
          .attr("class", "label")
          .style("fill-opacity", function (d) {
            return d.parent === root ? 1 : 0;
          })
          .style("display", function (d) {
            return d.parent === root ? "inline" : "none";
          })
          .text(function (d) {
            return d.data.name;
          });

        var node = g.selectAll("circle,.label,.code,.canada-map");

        svg
          .style("background", color(-1))
          .on("click", function (d) {
            d3.select(".docc").style("visibility","hidden");
            d3.select("#zoomableCircle").style("visibility","visible")
            zoom(root);
          });

        zoomTo([root.x, root.y, root.r * 2 + margin],.2);

        function zoom(d) {
          var focus0 = focus;
          focus = d;
          var ident = d.children[0].data.name;
          var token = 245.72930484471138
          var transition = d3.transition()
            .duration(d3.event.altKey ? 7500 : 750)
            .tween("zoom", function (d) {
              var i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2 + margin]);

              return function (t) {

                zoomTo(i(t),token/i(t)[2],t);
              };
            });
          transition.selectAll(".label")
            .filter(function (d) {
              return d.parent === focus || this.style.display === "inline";
            })
            .style("fill-opacity", function (d) {
              return d.parent === focus ? 1 : 0;
            })
            .on("start", function (d) {
              if (d.parent === focus) this.style.display = "inline";
            })
            .on("end", function (d) {
              if (d.parent !== focus) this.style.display = "none";
            });
        }


        function zoomTo(v,t,u) {
          var k = diameter / v[2];
          view = v;
          node.attr("transform", function (d) {

            var identif = d.data.name;
            var oneTime = 0;
            var data = d;
            switch(identif) {


              case "Carte du Canada":

                d3.select(".canada-map")
                  .attr("transform", function (e) {
                    var sumTranX = ((data.x - v[0]) * k + 400);
                    var sumTranY = ((data.y - v[1]) * k + 400);
                    console.log(sumTranX,sumTranY);
                    return "translate(" + sumTranX + "," + sumTranY + "),scale(" + t + ") "
                  });
                break;

              case "canadaChartLine":

                d3.select("#canadaChartLine")
                  .attr("transform", function (e) {
                    var sumTranX = (data.x - v[0]) * k + 400;
                    var sumTranY = (data.y - v[1]) * k + 400;
                    return "translate(" + sumTranX + "," + sumTranY + "),scale(" + t + ") "
                  });
                break;
              case "CanadaTable":

                d3.select(".table")
                  .attr("transform", function (e) {
                    var sumTranX = ((data.x - v[0]) * k + 540)*1.0075;
                    var sumTranY = ((data.y - v[1]) * k + 540)*1.01;
console.log(sumTranX,sumTranY,t*.4)
                    return "translate(" + sumTranX + "," + sumTranY + "),scale(" + t+ ")"
                  });
                break;

              case "DunutChart":

                d3.select("#donutCircle1")
                  .attr("transform", function (e) {
                    var sumTranX = ((data.x - v[0]) * k + 540)*(.9+(.1*v[2]/1100));
                    var sumTranY = ((data.y - v[1]) * k + 540)*(.9+(.1*v[2]/1100));



                    return "translate(" + sumTranX + "," + sumTranY + "),scale(" + t *0.4+ ")"
                  });
                break;

            }
            return "translate(" + (d.x - v[0]) * k + "," + (d.y - v[1]) * k + ")";
          });
          circle.attr("r", function (d) {
            return d.r * k;
          });
        }

        d3.selectAll(".provinces")
          .on("mouseover",function (d) {
            d3.select(this).attr("fill","rgb(191,191,191")
            var provSelec = d.properties.PRFNAME;

            updateData(provSelec);
            tabulate(provSelec);

          })
          .on("mouseout", function (d) {

            d3.select(this).attr("fill", "rgb(132,132,132)")
            updateData("canada");tabulate("canada");

          })


// http://bl.ocks.org/d3noob/6bd13f974d6516f3e491
        function updateData(v) {

          var lineData= {};
          dataChartLine.forEach(function(d){
            var prov = Object.keys(d)[0];


            if(prov===v){
              lineData = d[prov]
              lineData.forEach(function(d) {
                d.close = +d.close;
                d.open = +d.open;
              });

              // Scale the range of the data
              //  sett(prov,lineData)

              x.domain(d3.extent(lineData, function(d) {return d.date; }));
              y.domain([0, d3.max(lineData, function(d) {
                return Math.max(d.close, d.open); })]);

              xAxis = d3.axisBottom(x);
              yAxis = d3.axisLeft(y);


              // Select the section we want to apply our changes to
              var chart = d3.select("#canadaChartLine").transition().ease(d3.easeSin) ;

              // Make the changes
              chart.selectAll(".line.close")
                .duration(750)
                .attr("d", valueline(lineData));
              chart.selectAll(".line.open")   // change the line
                .duration(750)
                .attr("d", valueline2(lineData));
              chart.select(".xAxis") // change the x axis
                .duration(10)
                .call(xAxis);
              chart.select(".yAxis") // change the y axis
                .duration(10)
                .call(yAxis);

            }
          })
        }


        function tabulate(v) {

          // var selectionSett = sett(prov,canadaData.prov);
          var tableValue =[];
          var lineData= {};
          dataChartLine.forEach(function(d) {
            var prov = Object.keys(d)[0];


            if (prov === v) {

              lineData = d[prov]
              lineData.forEach(function (d) {
                var date = d.date;
                var formatTime = d3.timeFormat("%B %d, %Y");
                date = formatTime(date);
                var data = {
                  date:date,
                  close:d.close,
                  open:d.open
                };
                return tableValue.push(data);
              });
            }
          })
          var provSel = "Canada";
          if(v === "Québec" || v === "Ontario" || v === "Nunavut"){
            provSel = v;
          }
          d3.select(".titleText").text([provSel])

          var  noText = 1;
          tableValue.forEach(function (p1) {

            var data = [p1.date];

            d3.select(".dataRecText.textNo"+noText).data(data).text([p1.date]);
            noText++;
            d3.select(".dataRecText.textNo"+noText).data(data).text([p1.open]);
            noText++;
            d3.select(".dataRecText.textNo"+noText).data(data).text([p1.close]);
            noText++;

          });


        }
// render the table






        ;

      }
    </script>
    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-XXXXX-X', 'auto');
      ga('send', 'pageview');
    </script>
    <!-- Built with love using Web Starter Kit -->
  </body>
</html>
